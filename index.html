<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BizVocab | Professional English</title>
    <!-- Briefcase Favicon -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%234F46E5'%3E%3Cpath d='M20 6h-4V4c0-1.1-.9-2-2-2h-4C8.9 2 8 2.9 8 4v2H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2zm-8-2h2v2h-2V4z'/%3E%3C/svg%3E">
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap');
        
        body { font-family: 'Inter', sans-serif; }

        /* Smooth Animations for Background */
        @keyframes float {
            0% { transform: translateY(0px) translateX(0px); }
            50% { transform: translateY(-20px) translateX(10px); }
            100% { transform: translateY(0px) translateX(0px); }
        }
        @keyframes float-reverse {
            0% { transform: translateY(0px) translateX(0px); }
            50% { transform: translateY(20px) translateX(-10px); }
            100% { transform: translateY(0px) translateX(0px); }
        }

        .blob {
            position: fixed;
            filter: blur(80px);
            z-index: -1;
            opacity: 0.6;
        }
        .blob-1 { top: -10%; left: -10%; width: 500px; height: 500px; background: #4F46E5; animation: float 8s infinite ease-in-out; }
        .blob-2 { bottom: -10%; right: -10%; width: 600px; height: 600px; background: #06B6D4; animation: float-reverse 10s infinite ease-in-out; }
        .blob-3 { top: 40%; left: 40%; width: 400px; height: 400px; background: #8B5CF6; animation: float 12s infinite ease-in-out; }

        /* Glassmorphism Cards */
        .glass-panel {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.5);
        }
        .dark .glass-panel {
            background: rgba(17, 24, 39, 0.8);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        /* Interactive Elements */
        .option-btn { transition: all 0.2s ease; }
        .option-btn:hover { transform: translateY(-2px); }
        .option-btn.selected { border-color: #4F46E5; background-color: #EEF2FF; color: #4F46E5; }
        
        .correct-answer { background-color: #D1FAE5 !important; border-color: #10B981 !important; color: #065F46 !important; }
        .wrong-answer { background-color: #FEE2E2 !important; border-color: #EF4444 !important; color: #991B1B !important; }
    </style>
</head>
<body class="bg-slate-50 text-slate-800 min-h-screen relative overflow-x-hidden transition-colors duration-300">

    <!-- Animated Background -->
    <div class="blob blob-1 rounded-full"></div>
    <div class="blob blob-2 rounded-full"></div>
    <div class="blob blob-3 rounded-full"></div>

    <!-- Navigation -->
    <nav class="fixed w-full z-50 glass-panel shadow-sm">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="flex items-center cursor-pointer" onclick="renderView('home')">
                    <i class="fas fa-briefcase text-indigo-600 text-2xl mr-2"></i>
                    <span class="font-bold text-xl tracking-tight text-slate-900">BizVocab</span>
                </div>
                <div class="hidden md:block">
                    <div class="ml-10 flex items-baseline space-x-4">
                        <button onclick="renderView('home')" class="hover:bg-indigo-100 text-slate-700 px-3 py-2 rounded-md text-sm font-medium transition">Home</button>
                        <button onclick="renderView('modules')" class="hover:bg-indigo-100 text-slate-700 px-3 py-2 rounded-md text-sm font-medium transition">Modules</button>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Container -->
    <main id="app-container" class="pt-24 pb-12 px-4 sm:px-6 lg:px-8 max-w-7xl mx-auto relative z-10">
        <!-- Content injected via JS -->
    </main>

    <!-- Footer -->
    <footer class="text-center py-6 text-slate-500 text-sm relative z-10">
        <p>Â© 2024 Business English Hub. Based on Cambridge Professional English materials.</p>
    </footer>

    <script>
        // DATA STORE: 66 Modules based on Business Vocabulary in Use
        const modules = [
            { id: 1, title: "Work and Jobs", icon: "fa-id-card", summary: "Discussing responsibilities and roles.", learning: { intro: "Describing what you do.", keyTerms: [{ term: "to work for", def: "Used with a company." }, { term: "in charge of", def: "Having control." }] }, exercises: [{ type: "match", instruction: "1.1 Match verbs.", questions: [{ q: "1. to work", options: ["for", "of", "about"], answer: 0 }] }, { type: "gapfill", instruction: "1.2 Sentences.", questions: [{ text: "I deal ___ customers.", answer: "with" }] }], test: [{ q: "I am responsible ___ sales.", options: ["for", "of"], answer: 0 }] },
            { id: 2, title: "Ways of Working", icon: "fa-clock", summary: "Flexitime and shifts.", learning: { intro: "Working patterns.", keyTerms: [{ term: "Flexitime", def: "Flexible hours." }, { term: "Shift work", def: "Different times." }] }, exercises: [{ type: "gapfill", instruction: "2.1 Sentences.", questions: [{ text: "I work the night ___.", answer: "shift" }] }], test: [{ q: "I work ___ home.", options: ["from", "at"], answer: 0 }] },
            { id: 3, title: "Recruitment and Selection", icon: "fa-user-plus", summary: "Hiring process.", learning: { intro: "Finding staff.", keyTerms: [{ term: "Recruit", def: "Hire." }, { term: "CV", def: "Curriculum Vitae." }] }, exercises: [{ type: "match", instruction: "3.1 Terms.", questions: [{ q: "Apply for", options: ["a job", "a CV"], answer: 0 }] }], test: [{ q: "List of candidates:", options: ["Shortlist", "Longlist"], answer: 0 }] },
            { id: 4, title: "Skills and Qualifications", icon: "fa-graduation-cap", summary: "Education and skills.", learning: { intro: "Qualifications.", keyTerms: [{ term: "Graduate", def: "Has a degree." }, { term: "Skilled", def: "Trained." }] }, exercises: [{ type: "gapfill", instruction: "4.1 Sentences.", questions: [{ text: "I have a ___ in law.", answer: "degree" }] }], test: [{ q: "MBA stands for Master of Business ___.", options: ["Administration", "Accountancy"], answer: 0 }] },
            { id: 5, title: "Pay and Benefits", icon: "fa-money-bill-wave", summary: "Salaries and wages.", learning: { intro: "Money.", keyTerms: [{ term: "Salary", def: "Monthly pay." }, { term: "Wages", def: "Weekly pay." }] }, exercises: [{ type: "match", instruction: "5.1 Pay.", questions: [{ q: "Bonus", options: ["Extra money", "Fixed pay"], answer: 0 }] }], test: [{ q: "Manual workers earn:", options: ["Wages", "Salary"], answer: 0 }] },
            { id: 6, title: "People and Workplaces", icon: "fa-users", summary: "Staff and offices.", learning: { intro: "The workforce.", keyTerms: [{ term: "Staff", def: "Employees." }, { term: "HQ", def: "Headquarters." }] }, exercises: [{ type: "gapfill", instruction: "6.1 Sentences.", questions: [{ text: "The ___ Office.", answer: "head" }] }], test: [{ q: "HR stands for Human ___.", options: ["Resources", "Rights"], answer: 0 }] },
            { id: 7, title: "The Career Ladder", icon: "fa-arrow-trend-up", summary: "Promotion and retiring.", learning: { intro: "Career paths.", keyTerms: [{ term: "Promotion", def: "Moving up." }, { term: "Resign", def: "Quit." }] }, exercises: [{ type: "match", instruction: "7.1 Terms.", questions: [{ q: "Retire", options: ["Stop at 65", "Fired"], answer: 0 }] }], test: [{ q: "To leave a job voluntarily:", options: ["Resign", "Sack"], answer: 0 }] },
            { id: 8, title: "Problems at Work", icon: "fa-triangle-exclamation", summary: "Safety and discrimination.", learning: { intro: "Issues.", keyTerms: [{ term: "Strike", def: "Stop work protest." }, { term: "Discrimination", def: "Unfair treatment." }] }, exercises: [{ type: "gapfill", instruction: "8.1 Safety.", questions: [{ text: "Fire ___.", answer: "drill" }] }], test: [{ q: "Being fired unfairly:", options: ["Unfair dismissal", "Bad leaving"], answer: 0 }] },
            { id: 9, title: "Managers and Directors", icon: "fa-user-tie", summary: "The board and hierarchy.", learning: { intro: "Leadership.", keyTerms: [{ term: "CEO", def: "Chief Exec." }, { term: "Board", def: "Group of directors." }] }, exercises: [{ type: "match", instruction: "9.1 Roles.", questions: [{ q: "Chairman", options: ["Head of board", "Head of sales"], answer: 0 }] }], test: [{ q: "CFO deals with:", options: ["Finance", "Factory"], answer: 0 }] },
            { id: 10, title: "Business Leaders", icon: "fa-chess-king", summary: "Entrepreneurs.", learning: { intro: "Founders.", keyTerms: [{ term: "Entrepreneur", def: "Business starter." }, { term: "Tycoon", def: "Rich owner." }] }, exercises: [{ type: "gapfill", instruction: "10.1 Leaders.", questions: [{ text: "He is a media ___.", answer: "mogul" }] }], test: [{ q: "Starter of a company:", options: ["Founder", "Finder"], answer: 0 }] },
            { id: 11, title: "Organizations 1", icon: "fa-building", summary: "Sole traders and Plcs.", learning: { intro: "Structures.", keyTerms: [{ term: "Sole Trader", def: "One owner." }, { term: "Plc", def: "Public company." }] }, exercises: [{ type: "match", instruction: "11.1 Types.", questions: [{ q: "Ltd", options: ["Private Limited", "Public Limited"], answer: 0 }] }], test: [{ q: "Owners of a Plc:", options: ["Shareholders", "Partners"], answer: 0 }] },
            { id: 12, title: "Organizations 2", icon: "fa-handshake", summary: "Mergers.", learning: { intro: "Joining forces.", keyTerms: [{ term: "Merger", def: "Joining." }, { term: "Acquisition", def: "Buying." }] }, exercises: [{ type: "gapfill", instruction: "12.1 Sentences.", questions: [{ text: "Hostile ___.", answer: "takeover" }] }], test: [{ q: "Two companies become one:", options: ["Merger", "Mixer"], answer: 0 }] },
            { id: 13, title: "Manufacturing", icon: "fa-industry", summary: "Production sectors.", learning: { intro: "Sectors.", keyTerms: [{ term: "Primary", def: "Raw materials." }, { term: "Secondary", def: "Making." }] }, exercises: [{ type: "match", instruction: "13.1 Sectors.", questions: [{ q: "Mining", options: ["Primary", "Secondary"], answer: 0 }] }], test: [{ q: "Service sector is:", options: ["Tertiary", "Primary"], answer: 0 }] },
            { id: 14, title: "Development Process", icon: "fa-flask", summary: "R&D.", learning: { intro: "New products.", keyTerms: [{ term: "R&D", def: "Research & Dev." }, { term: "Prototype", def: "First model." }] }, exercises: [{ type: "gapfill", instruction: "14.1 Process.", questions: [{ text: "Product ___.", answer: "launch" }] }], test: [{ q: "Testing phase:", options: ["Beta", "Alpha"], answer: 0 }] },
            { id: 15, title: "Innovation", icon: "fa-lightbulb", summary: "IP and ideas.", learning: { intro: "Copyright.", keyTerms: [{ term: "Patent", def: "Invention rights." }, { term: "Copyright", def: "Art/Text rights." }] }, exercises: [{ type: "match", instruction: "15.1 IP.", questions: [{ q: "Logo protection", options: ["Trademark", "Patent"], answer: 0 }] }], test: [{ q: "New idea:", options: ["Innovation", "Imitation"], answer: 0 }] },
            { id: 16, title: "Making Things", icon: "fa-hammer", summary: "Mass vs Hand made.", learning: { intro: "Production.", keyTerms: [{ term: "Mass-produced", def: "Factory volume." }, { term: "Hand-made", def: "Crafted." }] }, exercises: [{ type: "gapfill", instruction: "16.1 Sentences.", questions: [{ text: "Custom-___.", answer: "built" }] }], test: [{ q: "Made by machines:", options: ["Mass-produced", "Hand-crafted"], answer: 0 }] },
            { id: 17, title: "Materials", icon: "fa-boxes-packing", summary: "Suppliers and stock.", learning: { intro: "Supply chain.", keyTerms: [{ term: "Inventory", def: "Stock." }, { term: "Supplier", def: "Provider." }] }, exercises: [{ type: "match", instruction: "17.1 Terms.", questions: [{ q: "JIT", options: ["Just-In-Time", "Just-In-Team"], answer: 0 }] }], test: [{ q: "Goods held in store:", options: ["Inventory", "Investory"], answer: 0 }] },
            { id: 18, title: "Business Philosophies", icon: "fa-brain", summary: "TQM and Kaizen.", learning: { intro: "Quality ideas.", keyTerms: [{ term: "Kaizen", def: "Improvement." }, { term: "TQM", def: "Total Quality." }] }, exercises: [{ type: "gapfill", instruction: "18.1 Quality.", questions: [{ text: "Zero ___.", answer: "defects" }] }], test: [{ q: "Continuous improvement:", options: ["Kaizen", "Zen"], answer: 0 }] },
            { id: 19, title: "Buyers and Sellers", icon: "fa-store", summary: "Customers.", learning: { intro: "Buying.", keyTerms: [{ term: "Customer", def: "Buys." }, { term: "Consumer", def: "Uses." }] }, exercises: [{ type: "match", instruction: "19.1 People.", questions: [{ q: "Client", options: ["Professional service", "Shop buyer"], answer: 0 }] }], test: [{ q: "Person who uses:", options: ["Consumer", "Customer"], answer: 0 }] },
            { id: 20, title: "Markets", icon: "fa-chart-pie", summary: "Competition.", learning: { intro: "Rivals.", keyTerms: [{ term: "Market Share", def: "% of sales." }, { term: "Competitor", def: "Rival." }] }, exercises: [{ type: "gapfill", instruction: "20.1 Market.", questions: [{ text: "Market ___.", answer: "leader" }] }], test: [{ q: "One seller:", options: ["Monopoly", "Mono"], answer: 0 }] },
            { id: 21, title: "Marketing", icon: "fa-bullhorn", summary: "The 4 Ps.", learning: { intro: "Marketing Mix.", keyTerms: [{ term: "4 Ps", def: "Product, Price, Place, Promotion." }] }, exercises: [{ type: "match", instruction: "21.1 Ps.", questions: [{ q: "Place", options: ["Distribution", "Cost"], answer: 0 }] }], test: [{ q: "Focused on needs:", options: ["Market-driven", "Product-driven"], answer: 0 }] },
            { id: 22, title: "Brands", icon: "fa-tags", summary: "Loyalty and image.", learning: { intro: "Branding.", keyTerms: [{ term: "Brand Loyalty", def: "Returning customers." }, { term: "Image", def: "Reputation." }] }, exercises: [{ type: "gapfill", instruction: "22.1 Brands.", questions: [{ text: "Brand ___.", answer: "awareness" }] }], test: [{ q: "Supermarket brand:", options: ["Own-label", "No-label"], answer: 0 }] },
            { id: 23, title: "Price", icon: "fa-tag", summary: "Pricing strategies.", learning: { intro: "Costing.", keyTerms: [{ term: "Premium", def: "High price." }, { term: "Budget", def: "Low price." }] }, exercises: [{ type: "match", instruction: "23.1 Price.", questions: [{ q: "Loss leader", options: ["Sold cheap to attract", "Sold expensive"], answer: 0 }] }], test: [{ q: "Expensive:", options: ["Upmarket", "Downmarket"], answer: 0 }] },
            { id: 24, title: "Place", icon: "fa-truck", summary: "Distribution.", learning: { intro: "Channels.", keyTerms: [{ term: "Retailer", def: "Shop." }, { term: "Wholesaler", def: "Bulk seller." }] }, exercises: [{ type: "gapfill", instruction: "24.1 Place.", questions: [{ text: "Distribution ___.", answer: "channel" }] }], test: [{ q: "Middleman:", options: ["Intermediary", "Immediate"], answer: 0 }] },
            { id: 25, title: "Promotion", icon: "fa-bullhorn", summary: "Advertising.", learning: { intro: "Ads.", keyTerms: [{ term: "Sponsorship", def: "Funding events." }, { term: "Viral", def: "Spreading online." }] }, exercises: [{ type: "match", instruction: "25.1 Media.", questions: [{ q: "Billboard", options: ["Outdoor", "Radio"], answer: 0 }] }], test: [{ q: "Free gift:", options: ["Freebie", "Freezer"], answer: 0 }] },
            { id: 26, title: "E-commerce", icon: "fa-globe", summary: "Online business.", learning: { intro: "Internet.", keyTerms: [{ term: "B2B", def: "Business to Business." }, { term: "B2C", def: "Business to Consumer." }] }, exercises: [{ type: "gapfill", instruction: "26.1 Online.", questions: [{ text: "Shopping ___.", answer: "cart" }] }], test: [{ q: "Online only:", options: ["Dotcom", "Dotorg"], answer: 0 }] },
            { id: 27, title: "Money and Banking", icon: "fa-coins", summary: "Banks and loans.", learning: { intro: "Banking.", keyTerms: [{ term: "Interest", def: "Cost of loan." }, { term: "Mortgage", def: "House loan." }] }, exercises: [{ type: "match", instruction: "27.1 Bank.", questions: [{ q: "Overdraft", options: ["Negative balance", "Savings"], answer: 0 }] }], test: [{ q: "Money type:", options: ["Currency", "Current"], answer: 0 }] },
            { id: 28, title: "Corporate Finance", icon: "fa-file-invoice-dollar", summary: "Profit and loss.", learning: { intro: "Accounts.", keyTerms: [{ term: "Asset", def: "Owned." }, { term: "Liability", def: "Owed." }] }, exercises: [{ type: "gapfill", instruction: "28.1 Finance.", questions: [{ text: "Balance ___.", answer: "sheet" }] }], test: [{ q: "Sales revenue:", options: ["Turnover", "Turnout"], answer: 0 }] },
            { id: 29, title: "Stocks and Shares", icon: "fa-chart-line", summary: "The stock market.", learning: { intro: "Shares.", keyTerms: [{ term: "Share", def: "Ownership part." }, { term: "Dividend", def: "Profit payout." }] }, exercises: [{ type: "match", instruction: "29.1 Market.", questions: [{ q: "Bull market", options: ["Rising", "Falling"], answer: 0 }] }], test: [{ q: "Market crash:", options: ["Prices fall", "Prices rise"], answer: 0 }] },
            { id: 30, title: "Money and Finance", icon: "fa-chart-area", summary: "Macroeconomics.", learning: { intro: "Economy.", keyTerms: [{ term: "Inflation", def: "Prices up." }, { term: "Recession", def: "Economy down." }] }, exercises: [{ type: "gapfill", instruction: "30.1 Economy.", questions: [{ text: "Interest ___.", answer: "rate" }] }], test: [{ q: "GDP:", options: ["Gross Domestic Product", "Gross Daily Profit"], answer: 0 }] },
            { id: 31, title: "Financial Markets", icon: "fa-chart-line", summary: "Bonds/Futures.", learning: { intro: "Instruments.", keyTerms: [{ term: "Bond", def: "Govt loan." }, { term: "Commodity", def: "Raw material." }] }, exercises: [{ type: "match", instruction: "31.1 Terms.", questions: [{ q: "Hedge Fund", options: ["High risk", "Safe"], answer: 0 }] }], test: [{ q: "Rise in prices (bad):", options: ["Bubble", "Balloon"], answer: 0 }] },
            { id: 32, title: "Cultural Issues", icon: "fa-globe-americas", summary: "Culture.", learning: { intro: "Etiquette.", keyTerms: [{ term: "Etiquette", def: "Manners." }, { term: "Stereotype", def: "Fixed idea." }] }, exercises: [{ type: "gapfill", instruction: "32.1 Culture.", questions: [{ text: "Small ___.", answer: "talk" }] }], test: [{ q: "Being on time:", options: ["Punctuality", "Punching"], answer: 0 }] },
            { id: 33, title: "Business Across Cultures", icon: "fa-plane", summary: "Global manners.", learning: { intro: "Styles.", keyTerms: [{ term: "Power Distance", def: "Hierarchy." }, { term: "Hospitality", def: "Hosting." }] }, exercises: [{ type: "match", instruction: "33.1 Terms.", questions: [{ q: "Formality", options: ["Strict", "Relaxed"], answer: 0 }] }], test: [{ q: "Group focus:", options: ["Collectivism", "Individualism"], answer: 0 }] },
            { id: 34, title: "Telephone and Email", icon: "fa-phone", summary: "Comms.", learning: { intro: "Contact.", keyTerms: [{ term: "Put through", def: "Connect." }, { term: "Attachment", def: "File." }] }, exercises: [{ type: "gapfill", instruction: "34.1 Phone.", questions: [{ text: "Hold ___.", answer: "on" }] }], test: [{ q: "Copy email:", options: ["CC", "DD"], answer: 0 }] },
            { id: 35, title: "Business Meetings", icon: "fa-handshake", summary: "Agendas.", learning: { intro: "Meeting.", keyTerms: [{ term: "Agenda", def: "Plan." }, { term: "Minutes", def: "Notes." }] }, exercises: [{ type: "match", instruction: "35.1 Roles.", questions: [{ q: "Chair", options: ["Leader", "Writer"], answer: 0 }] }], test: [{ q: "Any Other Business:", options: ["AOB", "ABC"], answer: 0 }] },
            { id: 36, title: "Presentations 1", icon: "fa-person-chalkboard", summary: "Structure.", learning: { intro: "Talks.", keyTerms: [{ term: "Signposting", def: "Guiding." }, { term: "Visuals", def: "Slides." }] }, exercises: [{ type: "gapfill", instruction: "36.1 Talk.", questions: [{ text: "First of ___.", answer: "all" }] }], test: [{ q: "Paper summary:", options: ["Handout", "Handin"], answer: 0 }] },
            { id: 37, title: "Presentations 2", icon: "fa-microphone", summary: "Delivery.", learning: { intro: "Speaking.", keyTerms: [{ term: "Body Language", def: "Gestures." }, { term: "Rapport", def: "Connection." }] }, exercises: [{ type: "match", instruction: "37.1 Delivery.", questions: [{ q: "Pace", options: ["Speed", "Volume"], answer: 0 }] }], test: [{ q: "Question session:", options: ["Q&A", "Q&Q"], answer: 0 }] },
            { id: 38, title: "Negotiations 1", icon: "fa-comments-dollar", summary: "Bargaining.", learning: { intro: "Deals.", keyTerms: [{ term: "Win-win", def: "Good for all." }, { term: "Compromise", def: "Middle ground." }] }, exercises: [{ type: "gapfill", instruction: "38.1 Deal.", questions: [{ text: "Make a ___.", answer: "deal" }] }], test: [{ q: "Lowest offer:", options: ["Bottom line", "Base line"], answer: 0 }] },
            { id: 39, title: "Negotiations 2", icon: "fa-hand-holding-dollar", summary: "Conflict.", learning: { intro: "Problems.", keyTerms: [{ term: "Deadlock", def: "Stuck." }, { term: "Arbitration", def: "Judge." }] }, exercises: [{ type: "match", instruction: "39.1 Terms.", questions: [{ q: "Mediator", options: ["Helper", "Boss"], answer: 0 }] }], test: [{ q: "Final demand:", options: ["Ultimatum", "Ultimate"], answer: 0 }] },
            { id: 40, title: "Agreement", icon: "fa-thumbs-up", summary: "Opinions.", learning: { intro: "Views.", keyTerms: [{ term: "Diplomatic", def: "Polite." }, { term: "Consensus", def: "Agreed." }] }, exercises: [{ type: "gapfill", instruction: "40.1 Polite.", questions: [{ text: "I'm ___ I disagree.", answer: "afraid" }] }], test: [{ q: "I see your point:", options: ["Agreeing", "Disagreeing politely"], answer: 1 }] },
            { id: 41, title: "Discussion Meetings", icon: "fa-people-arrows", summary: "Debate.", learning: { intro: "Talking.", keyTerms: [{ term: "Brainstorm", def: "Ideas." }, { term: "Digress", def: "Off topic." }] }, exercises: [{ type: "match", instruction: "41.1 Terms.", questions: [{ q: "Wrap up", options: ["Finish", "Start"], answer: 0 }] }], test: [{ q: "Stop speaker:", options: ["Interrupt", "Interpret"], answer: 0 }] },
            { id: 42, title: "Quality", icon: "fa-certificate", summary: "Standards.", learning: { intro: "Good work.", keyTerms: [{ term: "QC", def: "Checking." }, { term: "QA", def: "Systems." }] }, exercises: [{ type: "gapfill", instruction: "42.1 Quality.", questions: [{ text: "Fit for ___.", answer: "purpose" }] }], test: [{ q: "Official check:", options: ["Audit", "Edit"], answer: 0 }] },
            { id: 43, title: "Customer Service", icon: "fa-headset", summary: "Service.", learning: { intro: "Help.", keyTerms: [{ term: "Refund", def: "Money back." }, { term: "Feedback", def: "Comments." }] }, exercises: [{ type: "match", instruction: "43.1 Terms.", questions: [{ q: "Complaint", options: ["Problem", "Praise"], answer: 0 }] }], test: [{ q: "Understanding:", options: ["Empathy", "Apathy"], answer: 0 }] },
            { id: 44, title: "Management Styles", icon: "fa-sitemap", summary: "Leadership.", learning: { intro: "Styles.", keyTerms: [{ term: "Autocratic", def: "Strict." }, { term: "Democratic", def: "Open." }] }, exercises: [{ type: "gapfill", instruction: "44.1 Styles.", questions: [{ text: "Laissez-___.", answer: "faire" }] }], test: [{ q: "Giving tasks:", options: ["Delegating", "Deleting"], answer: 0 }] },
            { id: 45, title: "Recruitment", icon: "fa-user-plus", summary: "Hiring.", learning: { intro: "Staffing.", keyTerms: [{ term: "Turnover", def: "Leavers." }, { term: "Headhunter", def: "Recruiter." }] }, exercises: [{ type: "match", instruction: "45.1 Hiring.", questions: [{ q: "Vacancy", options: ["Open job", "Holiday"], answer: 0 }] }], test: [{ q: "Keeping staff:", options: ["Retention", "Detention"], answer: 0 }] },
            { id: 46, title: "Business Ethics", icon: "fa-scale-balanced", summary: "Ethics.", learning: { intro: "Morals.", keyTerms: [{ term: "CSR", def: "Social Resp." }, { term: "Stakeholder", def: "Affected." }] }, exercises: [{ type: "gapfill", instruction: "46.1 Ethics.", questions: [{ text: "Fair ___.", answer: "trade" }] }], test: [{ q: "Bad factory:", options: ["Sweatshop", "Sweetshop"], answer: 0 }] },
            { id: 47, title: "The Economy", icon: "fa-chart-bar", summary: "Macro.", learning: { intro: "State.", keyTerms: [{ term: "Fiscal", def: "Tax." }, { term: "Monetary", def: "Rates." }] }, exercises: [{ type: "match", instruction: "47.1 Economy.", questions: [{ q: "Austerity", options: ["Cuts", "Spending"], answer: 0 }] }], test: [{ q: "Fast growth:", options: ["Boom", "Bang"], answer: 0 }] },
            { id: 48, title: "Business Cycle", icon: "fa-rotate", summary: "Cycles.", learning: { intro: "Trends.", keyTerms: [{ term: "Peak", def: "Top." }, { term: "Trough", def: "Bottom." }] }, exercises: [{ type: "gapfill", instruction: "48.1 Cycle.", questions: [{ text: "Economic ___.", answer: "recovery" }] }], test: [{ q: "Two quarters decline:", options: ["Recession", "Procession"], answer: 0 }] },
            { id: 49, title: "CSR", icon: "fa-hand-holding-heart", summary: "Social good.", learning: { intro: "Responsibility.", keyTerms: [{ term: "Sustainability", def: "Green." }, { term: "Philanthropy", def: "Charity." }] }, exercises: [{ type: "match", instruction: "49.1 CSR.", questions: [{ q: "Transparency", options: ["Open", "Closed"], answer: 0 }] }], test: [{ q: "Triple Bottom Line:", options: ["People Planet Profit", "Product Price Place"], answer: 0 }] },
            { id: 50, title: "Environment", icon: "fa-leaf", summary: "Green.", learning: { intro: "Eco.", keyTerms: [{ term: "Carbon Footprint", def: "CO2." }, { term: "Renewable", def: "Green energy." }] }, exercises: [{ type: "gapfill", instruction: "50.1 Eco.", questions: [{ text: "Climate ___.", answer: "change" }] }], test: [{ q: "Fake green:", options: ["Greenwashing", "Whitewashing"], answer: 0 }] },
            { id: 51, title: "Entertaining", icon: "fa-champagne-glasses", summary: "Social.", learning: { intro: "Fun.", keyTerms: [{ term: "Small Talk", def: "Chat." }, { term: "Host", def: "Inviter." }] }, exercises: [{ type: "match", instruction: "51.1 Social.", questions: [{ q: "Toast", options: ["Drink to health", "Bread"], answer: 0 }] }], test: [{ q: "Who pays:", options: ["Host", "Guest"], answer: 0 }] },
            { id: 52, title: "Business Travel", icon: "fa-plane-departure", summary: "Travel.", learning: { intro: "Trips.", keyTerms: [{ term: "Itinerary", def: "Plan." }, { term: "Jet Lag", def: "Tired." }] }, exercises: [{ type: "gapfill", instruction: "52.1 Travel.", questions: [{ text: "Boarding ___.", answer: "pass" }] }], test: [{ q: "Hotel paper:", options: ["Bill", "Menu"], answer: 0 }] },
            { id: 53, title: "Communication", icon: "fa-envelope-open-text", summary: "Messages.", learning: { intro: "Comms.", keyTerms: [{ term: "Memo", def: "Note." }, { term: "Briefing", def: "Update." }] }, exercises: [{ type: "match", instruction: "53.1 Docs.", questions: [{ q: "Report", options: ["Analysis", "Letter"], answer: 0 }] }], test: [{ q: "Face to face:", options: ["In person", "Email"], answer: 0 }] },
            { id: 54, title: "Innovation 2", icon: "fa-cogs", summary: "Product life.", learning: { intro: "Lifecycle.", keyTerms: [{ term: "Maturity", def: "Peak sales." }, { term: "Decline", def: "Sales drop." }] }, exercises: [{ type: "gapfill", instruction: "54.1 Lifecycle.", questions: [{ text: "Product ___.", answer: "launch" }] }], test: [{ q: "Improving:", options: ["Kaizen", "Zen"], answer: 0 }] },
            { id: 55, title: "IT", icon: "fa-laptop-code", summary: "Tech.", learning: { intro: "Computers.", keyTerms: [{ term: "Hardware", def: "Parts." }, { term: "Software", def: "Code." }] }, exercises: [{ type: "match", instruction: "55.1 IT.", questions: [{ q: "Virus", options: ["Bad code", "Good code"], answer: 0 }] }], test: [{ q: "Internet storage:", options: ["Cloud", "Sky"], answer: 0 }] },
            { id: 56, title: "Change Management", icon: "fa-arrows-spin", summary: "Change.", learning: { intro: "Restructuring.", keyTerms: [{ term: "Downsizing", def: "Cuts." }, { term: "Merger", def: "Joining." }] }, exercises: [{ type: "gapfill", instruction: "56.1 Change.", questions: [{ text: "Staff ___.", answer: "morale" }] }], test: [{ q: "Moving office:", options: ["Relocation", "Location"], answer: 0 }] },
            { id: 57, title: "Global Brands", icon: "fa-earth-americas", summary: "Global.", learning: { intro: "World.", keyTerms: [{ term: "Multinational", def: "Global corp." }, { term: "Glocalization", def: "Global+Local." }] }, exercises: [{ type: "match", instruction: "57.1 Brands.", questions: [{ q: "Standardize", options: ["Same", "Different"], answer: 0 }] }], test: [{ q: "Home market:", options: ["Domestic", "Foreign"], answer: 0 }] },
            { id: 58, title: "Choice and Quality", icon: "fa-star", summary: "Quality.", learning: { intro: "Options.", keyTerms: [{ term: "Premium", def: "High." }, { term: "Budget", def: "Low." }] }, exercises: [{ type: "gapfill", instruction: "58.1 Choice.", questions: [{ text: "Value for ___.", answer: "money" }] }], test: [{ q: "Top quality:", options: ["Top-notch", "Top-heavy"], answer: 0 }] },
            { id: 59, title: "Logistics", icon: "fa-truck-fast", summary: "Supply.", learning: { intro: "Moving.", keyTerms: [{ term: "Freight", def: "Cargo." }, { term: "Hub", def: "Center." }] }, exercises: [{ type: "match", instruction: "59.1 Logistics.", questions: [{ q: "Warehouse", options: ["Store", "Shop"], answer: 0 }] }], test: [{ q: "Supply ___:", options: ["Chain", "Rope"], answer: 0 }] },
            { id: 60, title: "Finance/Economy", icon: "fa-piggy-bank", summary: "Money.", learning: { intro: "Markets.", keyTerms: [{ term: "Equity", def: "Shares." }, { term: "Yield", def: "Return." }] }, exercises: [{ type: "gapfill", instruction: "60.1 Finance.", questions: [{ text: "Bull ___.", answer: "market" }] }], test: [{ q: "Borrowing cost:", options: ["Interest", "Tax"], answer: 0 }] },
            { id: 61, title: "International Business", icon: "fa-globe", summary: "Trade.", learning: { intro: "Export.", keyTerms: [{ term: "Tariff", def: "Tax." }, { term: "Quota", def: "Limit." }] }, exercises: [{ type: "match", instruction: "61.1 Trade.", questions: [{ q: "Embargo", options: ["Ban", "Allow"], answer: 0 }] }], test: [{ q: "Selling abroad:", options: ["Export", "Import"], answer: 0 }] },
            { id: 62, title: "Business Skills", icon: "fa-briefcase", summary: "Skills.", learning: { intro: "Ability.", keyTerms: [{ term: "Negotiation", def: "Deals." }, { term: "Leadership", def: "Leading." }] }, exercises: [{ type: "gapfill", instruction: "62.1 Skills.", questions: [{ text: "Time ___.", answer: "management" }] }], test: [{ q: "Group talk:", options: ["Meeting", "Eating"], answer: 0 }] },
            { id: 63, title: "Intercultural Comm", icon: "fa-comments", summary: "Culture.", learning: { intro: "Context.", keyTerms: [{ term: "High Context", def: "Indirect." }, { term: "Low Context", def: "Direct." }] }, exercises: [{ type: "match", instruction: "63.1 Culture.", questions: [{ q: "Faux pas", options: ["Mistake", "Correct"], answer: 0 }] }], test: [{ q: "Personal space:", options: ["Proxemics", "Proximity"], answer: 0 }] },
            { id: 64, title: "Business Trends", icon: "fa-arrow-trend-up", summary: "Trends.", learning: { intro: "Future.", keyTerms: [{ term: "Gig economy", def: "Freelance." }, { term: "AI", def: "Computers." }] }, exercises: [{ type: "gapfill", instruction: "64.1 Trends.", questions: [{ text: "Remote ___.", answer: "work" }] }], test: [{ q: "Freelance world:", options: ["Gig economy", "Big economy"], answer: 0 }] },
            { id: 65, title: "Quality Management", icon: "fa-check-double", summary: "Standards.", learning: { intro: "ISO.", keyTerms: [{ term: "ISO", def: "Standard." }, { term: "Audit", def: "Check." }] }, exercises: [{ type: "match", instruction: "65.1 QA.", questions: [{ q: "Fishbone", options: ["Diagram", "Fish"], answer: 0 }] }], test: [{ q: "Zero ___:", options: ["Defects", "Effects"], answer: 0 }] },
            { id: 66, title: "Developing Skills", icon: "fa-seedling", summary: "Growth.", learning: { intro: "Self.", keyTerms: [{ term: "Hard skills", def: "Technical." }, { term: "Soft skills", def: "People." }] }, exercises: [{ type: "gapfill", instruction: "66.1 Growth.", questions: [{ text: "Emotional ___.", answer: "intelligence" }] }], test: [{ q: "EQ means:", options: ["Emotional Quotient", "Equal Quality"], answer: 0 }] }
        ];

        // Groups Config
        const groups = [
            { title: "Jobs, People and Organizations", start: 1, end: 12 },
            { title: "Production", start: 13, end: 18 },
            { title: "Marketing", start: 19, end: 26 },
            { title: "Money", start: 27, end: 34 },
            { title: "Finance and the economy", start: 35, end: 39 },
            { title: "Doing the right thing", start: 40, end: 41 },
            { title: "Skills", start: 42, end: 44 },
            { title: "Culture", start: 45, end: 47 }, 
            { title: "Telephone, fax and email", start: 48, end: 53 },
            { title: "Business Skills", start: 54, end: 66 }
        ];

        // APP STATE
        let currentView = 'home';
        let currentModuleId = null;

        // INIT
        document.addEventListener('DOMContentLoaded', () => {
            renderView('home');
        });

        // VIEW CONTROLLER
        function renderView(viewName, moduleId = null) {
            const app = document.getElementById('app-container');
            app.innerHTML = ''; // Clear content
            app.style.opacity = 0; // Fade out effect

            setTimeout(() => {
                if (viewName === 'home') renderHome(app);
                else if (viewName === 'modules') renderModules(app);
                else if (viewName === 'module-detail') renderModuleDetail(app, moduleId);
                else if (viewName === 'test') renderTest(app, moduleId);
                
                app.style.transition = 'opacity 0.5s ease';
                app.style.opacity = 1;
            }, 200);
        }

        // RENDERERS
        function renderHome(container) {
            container.innerHTML = `
                <div class="text-center py-16">
                    <h1 class="text-5xl md:text-6xl font-bold text-slate-900 mb-6 tracking-tight">
                        Master Business <span class="text-transparent bg-clip-text bg-gradient-to-r from-indigo-600 to-cyan-500">English</span>
                    </h1>
                    <p class="text-xl text-slate-600 mb-10 max-w-2xl mx-auto">
                        Enhance your workplace vocabulary with interactive modules designed for B2 professionals. 
                        Based on the Cambridge Business Vocabulary curriculum.
                    </p>
                    <button onclick="renderView('modules')" class="bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-4 px-8 rounded-full shadow-lg transform transition hover:scale-105">
                        Start Learning <i class="fas fa-arrow-right ml-2"></i>
                    </button>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-3 gap-8 mt-12">
                    <div class="glass-panel p-6 rounded-xl shadow-sm text-center">
                        <div class="w-12 h-12 bg-indigo-100 rounded-full flex items-center justify-center mx-auto mb-4 text-indigo-600">
                            <i class="fas fa-book-open text-xl"></i>
                        </div>
                        <h3 class="font-bold text-lg mb-2">Detailed Theory</h3>
                        <p class="text-slate-600">Learn definitions, collocations, and grammar rules for the workplace.</p>
                    </div>
                    <div class="glass-panel p-6 rounded-xl shadow-sm text-center">
                        <div class="w-12 h-12 bg-cyan-100 rounded-full flex items-center justify-center mx-auto mb-4 text-cyan-600">
                            <i class="fas fa-laptop-code text-xl"></i>
                        </div>
                        <h3 class="font-bold text-lg mb-2">Interactive Practice</h3>
                        <p class="text-slate-600">Gap fills and matching exercises to reinforce your learning.</p>
                    </div>
                    <div class="glass-panel p-6 rounded-xl shadow-sm text-center">
                        <div class="w-12 h-12 bg-purple-100 rounded-full flex items-center justify-center mx-auto mb-4 text-purple-600">
                            <i class="fas fa-chart-line text-xl"></i>
                        </div>
                        <h3 class="font-bold text-lg mb-2">Module Tests</h3>
                        <p class="text-slate-600">Test your knowledge at the end of each module to track progress.</p>
                    </div>
                </div>
            `;
        }

        function renderModules(container) {
            let html = `
                <div class="mb-8">
                    <h2 class="text-4xl font-bold text-slate-800 text-center">Learning Modules</h2>
                    <p class="text-slate-600 text-center mt-2">Select a topic to begin studying.</p>
                </div>
            `;

            groups.forEach(group => {
                html += `
                    <div class="mb-12">
                        <h3 class="text-2xl font-bold text-indigo-700 mb-6 border-b-2 border-indigo-100 pb-2">${group.title}</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                `;
                
                const groupModules = modules.filter(m => m.id >= group.start && m.id <= group.end);
                
                if(groupModules.length === 0) {
                     html += `<p class="text-slate-400 italic">No modules in this section.</p>`;
                }

                groupModules.forEach(mod => {
                    html += `
                        <div class="glass-panel rounded-xl p-6 hover:shadow-md transition cursor-pointer group hover:-translate-y-1 duration-300" onclick="renderView('module-detail', ${mod.id})">
                            <div class="flex items-center justify-between mb-4">
                                <span class="text-xs font-bold uppercase text-indigo-500 tracking-wider">Module ${mod.id}</span>
                                <i class="fas ${mod.icon} text-slate-400 group-hover:text-indigo-600 transition"></i>
                            </div>
                            <h3 class="text-xl font-bold text-slate-800 mb-2 group-hover:text-indigo-600 transition">${mod.title}</h3>
                            <p class="text-slate-600 text-sm mb-4 line-clamp-2">${mod.summary}</p>
                            <div class="w-full bg-slate-200 rounded-full h-1.5 mt-2">
                                <div class="bg-indigo-500 h-1.5 rounded-full" style="width: 0%"></div>
                            </div>
                        </div>
                    `;
                });

                html += `</div></div>`;
            });

            container.innerHTML = html;
        }

        function renderModuleDetail(container, id) {
            const mod = modules.find(m => m.id === id);
            
            let html = `
                <button onclick="renderView('modules')" class="mb-6 text-slate-500 hover:text-indigo-600 transition flex items-center">
                    <i class="fas fa-arrow-left mr-2"></i> Back to Modules
                </button>
                
                <div class="glass-panel rounded-2xl p-8 mb-8 border-l-4 border-indigo-500">
                    <h1 class="text-3xl font-bold text-slate-900 mb-2">Unit ${mod.id}: ${mod.title}</h1>
                    <p class="text-lg text-slate-600">${mod.learning.intro}</p>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                    <!-- Theory Section -->
                    <div class="lg:col-span-1">
                        <div class="bg-white rounded-xl shadow-sm p-6 sticky top-24 border border-slate-100">
                            <h3 class="text-xl font-bold text-slate-800 mb-4 border-b pb-2 flex items-center"><i class="fas fa-book mr-2 text-indigo-500"></i>Key Vocabulary</h3>
                            <ul class="space-y-4">
                                ${mod.learning.keyTerms.map(term => `
                                    <li class="group">
                                        <span class="block font-bold text-indigo-600 group-hover:text-indigo-700 transition">${term.term}</span>
                                        <span class="text-sm text-slate-600 leading-relaxed">${term.def}</span>
                                    </li>
                                `).join('')}
                            </ul>
                        </div>
                    </div>

                    <!-- Exercises Section -->
                    <div class="lg:col-span-2 space-y-8">
                        ${mod.exercises.map((ex, index) => renderExercise(ex, index)).join('')}
                        
                        <div class="glass-panel p-8 rounded-xl text-center mt-10">
                            <h3 class="text-2xl font-bold mb-4">Ready to test yourself?</h3>
                            <button onclick="renderView('test', ${mod.id})" class="bg-gradient-to-r from-indigo-600 to-purple-600 text-white font-bold py-3 px-8 rounded-lg shadow-lg hover:shadow-xl transition transform hover:-translate-y-1">
                                Take Module Test
                            </button>
                        </div>
                    </div>
                </div>
            `;
            container.innerHTML = html;
        }

        function renderExercise(ex, index) {
            let content = '';
            
            if (ex.type === 'gapfill') {
                content = `<div class="space-y-4">`;
                ex.questions.forEach((q, qIdx) => {
                    const parts = q.text.split('___');
                    content += `
                        <div class="flex items-baseline flex-wrap gap-2 text-lg">
                            <span class="font-medium text-slate-700">${qIdx + 1}. ${parts[0]}</span>
                            <input type="text" data-ans="${q.answer}" class="gap-input bg-white border border-slate-300 rounded px-2 py-1 focus:ring-2 focus:ring-indigo-500 outline-none w-32 text-center font-bold text-indigo-600 shadow-sm" placeholder="?">
                            <span class="font-medium text-slate-700">${parts[1] || ''}</span>
                            <span class="feedback-icon hidden ml-2"></span>
                        </div>
                    `;
                });
                content += `</div>`;
            } else if (ex.type === 'match') {
                content = `<div class="space-y-6">`;
                ex.questions.forEach((q, qIdx) => {
                    content += `
                        <div class="bg-white p-4 rounded-lg border border-slate-100 shadow-sm">
                            <p class="font-medium mb-3 text-slate-800">${qIdx + 1}. ${q.q}</p>
                            <div class="flex flex-wrap gap-2">
                                ${q.options.map((opt, oIdx) => `
                                    <button onclick="selectOption(this, ${q.answer === oIdx})" class="option-btn border border-slate-300 px-4 py-2 rounded-full text-sm hover:bg-slate-50 transition text-slate-600">
                                        ${opt}
                                    </button>
                                `).join('')}
                            </div>
                        </div>
                    `;
                });
                content += `</div>`;
            }

            return `
                <div class="glass-panel p-6 rounded-xl relative overflow-hidden">
                    <div class="absolute top-0 right-0 p-4 opacity-10">
                        <i class="fas fa-pencil-alt text-6xl"></i>
                    </div>
                    <div class="flex items-center mb-6 relative z-10">
                        <span class="bg-indigo-100 text-indigo-700 text-xs font-bold px-2 py-1 rounded uppercase mr-2 tracking-wide">Activity ${index + 1}</span>
                        <h4 class="font-bold text-slate-800 text-lg">${ex.instruction}</h4>
                    </div>
                    <div class="relative z-10">
                        ${content}
                        ${ex.type === 'gapfill' ? `<button onclick="checkGapFill(this)" class="mt-6 text-sm bg-slate-800 text-white px-6 py-2.5 rounded-lg hover:bg-slate-700 transition shadow-lg flex items-center"><i class="fas fa-check mr-2"></i> Check Answers</button>` : ''}
                    </div>
                </div>
            `;
        }

        function renderTest(container, id) {
            const mod = modules.find(m => m.id === id);
            
            let html = `
                <div class="max-w-3xl mx-auto">
                    <div class="text-center mb-10">
                        <span class="text-indigo-600 font-bold tracking-wider uppercase text-sm">Assessment</span>
                        <h2 class="text-4xl font-bold text-slate-900 mt-2">Test: ${mod.title}</h2>
                        <p class="text-slate-500 mt-2">Select the correct answer for each question.</p>
                    </div>

                    <div class="space-y-6" id="test-form">
                        ${mod.test.map((q, idx) => `
                            <div class="glass-panel p-6 rounded-xl test-question transition hover:shadow-md" data-correct="${q.answer}">
                                <p class="text-xl font-medium mb-4 text-slate-800"><span class="text-indigo-400 mr-2 font-bold">${idx + 1}.</span>${q.q.replace('___', '______')}</p>
                                <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
                                    ${q.options.map((opt, oIdx) => `
                                        <label class="flex items-center p-4 border rounded-lg cursor-pointer hover:bg-indigo-50 transition border-slate-200 bg-white group">
                                            <input type="radio" name="q${idx}" value="${oIdx}" class="text-indigo-600 focus:ring-indigo-500 h-5 w-5 border-gray-300">
                                            <span class="ml-3 text-slate-600 group-hover:text-slate-900 font-medium">${opt}</span>
                                        </label>
                                    `).join('')}
                                </div>
                            </div>
                        `).join('')}
                    </div>

                    <div class="mt-12 text-center pb-20">
                        <button onclick="submitTest()" class="bg-green-600 hover:bg-green-700 text-white font-bold py-4 px-12 rounded-full shadow-lg transform transition hover:scale-105 text-lg flex items-center mx-auto">
                            <i class="fas fa-paper-plane mr-2"></i> Submit Answers
                        </button>
                        <button onclick="renderView('module-detail', ${id})" class="mt-6 text-slate-500 hover:text-slate-700 underline text-sm">Cancel and Return</button>
                    </div>
                </div>

                <!-- Result Modal Overlay -->
                <div id="result-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center px-4 backdrop-blur-sm">
                    <div class="bg-white rounded-2xl p-8 max-w-md w-full text-center shadow-2xl transform scale-90 opacity-0 transition-all duration-300" id="result-content">
                        <div id="score-icon" class="text-6xl mb-4"></div>
                        <h3 class="text-3xl font-bold mb-2 text-slate-800">Test Complete!</h3>
                        <p class="text-slate-600 mb-8 text-lg">You scored <span id="score-val" class="font-bold text-4xl text-indigo-600"></span> out of <span id="score-total" class="text-xl"></span></p>
                        <div class="flex justify-center space-x-4">
                            <button onclick="renderView('module-detail', ${id}); closeModal()" class="px-6 py-3 border border-slate-300 rounded-lg text-slate-700 hover:bg-slate-50 font-medium">Review Unit</button>
                            <button onclick="renderView('modules'); closeModal()" class="px-6 py-3 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 font-medium shadow-md">Next Module</button>
                        </div>
                    </div>
                </div>
            `;
            container.innerHTML = html;
        }

        // INTERACTION LOGIC

        // For Multiple Choice Practice
        window.selectOption = function(btn, isCorrect) {
            // Reset siblings
            const parent = btn.parentElement;
            const buttons = parent.querySelectorAll('button');
            buttons.forEach(b => {
                b.classList.remove('correct-answer', 'wrong-answer', 'bg-red-50', 'bg-green-50', 'border-red-500', 'border-green-500', 'text-red-700', 'text-green-700');
                b.disabled = true; // Disable after selection
                b.classList.add('opacity-60');
            });

            btn.classList.remove('opacity-60');

            if (isCorrect) {
                btn.classList.add('correct-answer');
                btn.innerHTML += ' <i class="fas fa-check-circle ml-2"></i>';
            } else {
                btn.classList.add('wrong-answer');
                btn.innerHTML += ' <i class="fas fa-times-circle ml-2"></i>';
            }
        };

        // For Gap Fill
        window.checkGapFill = function(btn) {
            const container = btn.parentElement.previousElementSibling; // Content div
            const inputs = container.querySelectorAll('input');
            let allCorrect = true;

            inputs.forEach(input => {
                const userAns = input.value.trim().toLowerCase();
                const correctAns = input.dataset.ans.toLowerCase();
                const icon = input.nextElementSibling.nextElementSibling; // span.feedback-icon

                icon.classList.remove('hidden');
                input.classList.remove('border-slate-300', 'focus:ring-indigo-500');

                if (userAns === correctAns) {
                    input.classList.add('border-green-500', 'text-green-700', 'bg-green-50');
                    input.classList.remove('border-red-500', 'text-red-700', 'bg-red-50');
                    icon.innerHTML = '<i class="fas fa-check text-green-500"></i>';
                } else {
                    input.classList.add('border-red-500', 'text-red-700', 'bg-red-50');
                    input.classList.remove('border-green-500', 'text-green-700', 'bg-green-50');
                    icon.innerHTML = `<i class="fas fa-times text-red-500"></i> <span class="text-xs text-red-500 ml-1 font-bold">${correctAns}</span>`;
                    allCorrect = false;
                }
            });

            if (allCorrect) {
                btn.innerHTML = '<i class="fas fa-star mr-2"></i> Great Job!';
                btn.className = "mt-6 text-sm bg-green-600 text-white px-6 py-2.5 rounded-lg shadow-lg cursor-default";
            } else {
                btn.innerHTML = '<i class="fas fa-redo mr-2"></i> Try Again';
            }
        };

        // For Test Submission
        window.submitTest = function() {
            const questions = document.querySelectorAll('.test-question');
            let score = 0;
            let total = questions.length;

            questions.forEach((qDiv, idx) => {
                const correctIdx = parseInt(qDiv.dataset.correct);
                const selected = qDiv.querySelector(`input[name="q${idx}"]:checked`);
                const labels = qDiv.querySelectorAll('label');
                
                // Reset styles
                labels.forEach(l => l.classList.remove('bg-green-100', 'border-green-500', 'bg-red-100', 'border-red-500'));

                if (selected) {
                    if (parseInt(selected.value) === correctIdx) {
                        score++;
                        selected.parentElement.classList.add('bg-green-100', 'border-green-500');
                        selected.parentElement.innerHTML += '<i class="fas fa-check text-green-600 ml-auto"></i>';
                    } else {
                        selected.parentElement.classList.add('bg-red-100', 'border-red-500');
                        labels[correctIdx].classList.add('bg-green-100', 'border-green-500'); // Show correct
                    }
                } else {
                    // No answer selected, highlight correct
                    labels[correctIdx].classList.add('bg-green-100', 'border-green-500');
                }
            });

            // Show Modal
            const modal = document.getElementById('result-modal');
            const content = document.getElementById('result-content');
            const icon = document.getElementById('score-icon');
            
            document.getElementById('score-val').innerText = score;
            document.getElementById('score-total').innerText = total;

            if (score === total) {
                icon.innerHTML = 'ð';
                icon.className = "text-6xl mb-4 animate-bounce text-yellow-500";
            } else if (score > total / 2) {
                icon.innerHTML = 'ð';
                icon.className = "text-6xl mb-4 animate-pulse text-indigo-500";
            } else {
                icon.innerHTML = 'ð';
                icon.className = "text-6xl mb-4 text-slate-400";
            }

            modal.classList.remove('hidden');
            setTimeout(() => {
                content.classList.remove('scale-90', 'opacity-0');
                content.classList.add('scale-100', 'opacity-100');
            }, 10);
        };

        window.closeModal = function() {
            document.getElementById('result-modal').classList.add('hidden');
        };

    </script>
</body>
</html>
